# 大乐透分析工具使用文档

## 1. 概述

大乐透分析工具是一个功能强大的彩票数据分析软件，专为中国体育彩票大乐透设计。本工具能够自动爬取历史开奖数据，进行多维度分析，基于多种算法生成号码，并提供中奖对比功能。

## 2. 安装要求

### 2.1 系统要求
- Python 3.6 或更高版本
- 操作系统：Windows、macOS 或 Linux

### 2.2 依赖包安装

在使用本工具前，需要安装以下依赖包：

```bash
pip install pandas numpy matplotlib seaborn requests beautifulsoup4 networkx scipy scikit-learn
```

## 3. 基本功能

### 3.1 数据爬取

从中彩网获取大乐透历史开奖数据：

```bash
python main.py crawl
```

参数选项：
- `-d, --data-file`：指定保存数据的文件路径，默认为 `data/dlt_data.csv`
- `-c, --count`：指定爬取的期数，默认为300期

示例：
```bash
# 爬取500期数据并保存到指定位置
python main.py crawl -c 500 -d "my_data/lottery.csv"
```

### 3.2 数据分析

#### 3.2.1 基础分析

进行基本的数据统计和分析：

```bash
python main.py analyze
```

基础分析包括：
- 号码频率分析
- 遗漏值分析
- 热门号码分析
- 冷门号码分析
- 基本统计指标

#### 3.2.2 高级分析

进行更复杂的统计分析和预测模型构建：

```bash
python main.py analyze -a
```

高级分析包括：
- 统计学特征分析
- 概率分布分析
- 频率模式分析
- 马尔可夫链分析
- 贝叶斯分析

参数选项：
- `-d, --data-file`：指定数据文件路径，默认为 `data/dlt_data.csv`
- `-o, --output-dir`：指定输出目录，默认为 `output`
- `-p, --periods`：指定分析期数，0表示全部
- `-a, --advanced`：使用高级分析（需要加此参数）

示例：
```bash
# 分析最近100期数据并将结果输出到指定目录
python main.py analyze -p 100 -o "my_results" -a
```

### 3.3 号码生成

#### 3.3.1 随机生成

完全随机生成大乐透号码：

```bash
python main.py generate
```

#### 3.3.2 基于频率生成

根据历史号码出现频率生成：

```bash
python main.py generate -s frequency
```

#### 3.3.3 基于走势生成

根据近期走势和遗漏值生成：

```bash
python main.py generate -s trend
```

#### 3.3.4 混合策略生成

结合多种策略生成：

```bash
python main.py generate -s mixed
```

参数选项：
- `-d, --data-file`：指定数据文件路径
- `-c, --count`：指定生成号码注数，默认为5
- `-s, --strategy`：指定生成策略，可选值为 `random`、`frequency`、`trend`、`mixed`，默认为 `random`

示例：
```bash
# 使用混合策略生成10注号码
python main.py generate -s mixed -c 10
```

## 4. 高级功能

### 4.1 最新开奖结果查询

查看最新一期大乐透开奖结果：

```bash
python main.py latest
```

如果需要将自己的号码与最新开奖结果进行比对：

```bash
python main.py latest --compare
```

运行后会提示输入您的号码，然后显示匹配结果和中奖等级。

### 4.2 马尔可夫链分析和预测

使用马尔可夫链模型分析历史数据并生成预测号码：

```bash
python main.py markov
```

参数选项：
- `-c, --count`：指定生成预测号码注数，默认为5
- `-p, --periods`：指定分析期数，0表示全部

示例：
```bash
# 基于最近200期数据，使用马尔可夫模型生成8注预测号码
python main.py markov -p 200 -c 8
```

### 4.3 贝叶斯分析和预测

使用贝叶斯概率模型分析历史数据并生成预测号码：

```bash
python main.py bayesian
```

参数选项：
- `-c, --count`：指定生成预测号码注数，默认为5
- `-p, --periods`：指定分析期数，0表示全部

示例：
```bash
# 基于最近150期数据，使用贝叶斯模型生成3注预测号码
python main.py bayesian -p 150 -c 3
```

### 4.4 历史对比分析

将用户输入的号码与历史开奖结果进行对比分析：

```bash
python main.py compare
```

此功能会提示用户输入大乐透号码，然后分析该号码在历史上的表现，包括：
- 历史中奖情况
- 与历史号码的相似度
- 号码组合特征分析

## 5. 输出结果说明

### 5.1 数据文件

爬取的数据保存为CSV格式，包含以下字段：
- `issue`：期号
- `date`：开奖日期
- `front_balls`：前区号码（逗号分隔的字符串，如"01,15,20,25,32"）
- `back_balls`：后区号码（逗号分隔的字符串，如"05,12"）

### 5.2 分析结果

分析结果保存在输出目录中，包括：
- 数据统计表格
- 频率分析图表
- 遗漏值热图
- 走势图
- 预测模型参数
- 其他可视化结果

## 6. 注意事项

1. **数据依赖**：非随机生成的功能依赖历史数据，如果数据文件不存在，程序会尝试自动爬取数据。

2. **网络依赖**：爬取数据和查询最新开奖结果需要网络连接。如果网络连接不稳定，可能会导致数据爬取失败。

3. **免责声明**：本工具仅供学习和研究使用，不构成任何购彩建议。彩票有风险，购买需谨慎。

4. **数据更新**：建议定期运行爬虫命令更新数据，以获取最新的开奖结果。

5. **资源占用**：高级分析功能可能需要消耗较多计算资源和时间，特别是在数据量大的情况下。

## 7. 故障排除

### 7.1 常见问题

1. **数据爬取失败**：
   - 检查网络连接
   - 尝试减少爬取期数（使用 `-c` 参数）
   - 中彩网可能更改了页面结构，需要更新爬虫代码

2. **分析报错**：
   - 检查数据文件是否完整
   - 使用 `validate_dlt_data` 函数验证数据格式

3. **输出目录问题**：
   - 确保指定的输出目录存在或具有创建权限

### 7.2 错误代码说明

- 如遇到程序崩溃或异常，请检查控制台输出的错误信息
- 大多数异常会被捕获并显示友好的错误提示

## 8. 项目结构

```
大乐透分析工具/
│
├── main.py               # 主程序，提供命令行接口
├── cwl_crawler.py        # 爬虫模块，获取大乐透历史数据
├── basic_analyzer.py     # 基础分析器，提供基本数据分析
├── advanced_analyzer.py  # 高级分析器，提供高级分析和预测
├── utils.py              # 工具函数，提供通用数据处理功能
│
├── data/                 # 数据目录
│   └── dlt_data.csv      # 大乐透历史数据
│
└── output/               # 输出目录
    ├── frequency_analysis.png
    ├── missing_value_heatmap.png
    ├── trend_chart.png
    └── ... 
```

## 9. 命令参考

| 命令 | 功能描述 | 常用参数 |
|------|----------|---------|
| `crawl` | 爬取历史数据 | `-c/--count`, `-d/--data-file` |
| `analyze` | 分析历史数据 | `-a/--advanced`, `-p/--periods`, `-o/--output-dir` |
| `generate` | 生成号码 | `-s/--strategy`, `-c/--count` |
| `latest` | 查询最新开奖 | `--compare` |
| `markov` | 马尔可夫链分析 | `-c/--count`, `-p/--periods` |
| `bayesian` | 贝叶斯分析 | `-c/--count`, `-p/--periods` |
| `compare` | 历史对比分析 | - | 